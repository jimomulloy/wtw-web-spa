<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Employee Directory</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!--script src="lib/underscore-min.js"></script-->

<!--link href="bootstrap/css/bootstrap.min.css" rel="stylesheet"
	media="screen">
<link href="bootstrap/css/bootstrap-responsive.css" rel="stylesheet"-->

<!-- Latest compiled and minified CSS -->
<link rel="stylesheet"
	href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">

<!-- Optional theme -->
<link rel="stylesheet"
	href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap-theme.min.css">

<link href="css/styles.css" rel="stylesheet">

<!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
<!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

<script src="http://use.edgefonts.net/source-sans-pro.js"></script>

<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>

<!-- Latest compiled and minified JavaScript -->
<script
	src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>

<style type="text/css">
hr {
	margin: 0 0;
}

#map_canvas_alt {
	width: 100%;
	height: 100%;
	min-height: 100%;
	display: block;
	border-radius: 10px;
	-webkit-border-radius: 10px;
}

#map_canvas {
	width: 500px;
	height: 400px;
	background-color: #CCC;
	min-height: 100%;
	display: block;
	border-radius: 10px;
	-webkit-border-radius: 10px;
}

.well {
	width: 100%;
	height: 100%;
	min-height: 100%;
}

.alert {
	border: 1px solid rgba(229, 223, 59, 0.78);
}
</style>

<script src="https://maps.googleapis.com/maps/api/js"></script>


<script type="text/javascript">
	function initialize() {
		var latlng = new google.maps.LatLng(51.4800, 0.00);
		var settings = {
			zoom : 10,
			center : latlng,
			mapTypeControl : false,
			mapTypeControlOptions : {
				style : google.maps.MapTypeControlStyle.DROPDOWN_MENU
			},
			navigationControl : true,
			navigationControlOptions : {
				style : google.maps.NavigationControlStyle.SMALL
			},
			mapTypeId : google.maps.MapTypeId.TERRAIN
		};

		var map = new google.maps.Map(document.getElementById("map_canvas"),
				settings);

		google.maps.event.addListener(map, 'click', function(event) {
			$('#latitude').val(event.latLng.lat());
			$('#longitude').val(event.latLng.lng());
		});

		var wespiMarker = new google.maps.Marker({
			position : latlng,
			map : map,
			title : "London, UK"
		});
		startws();

	}

	function startws() {
		var socket = new WebSocket("ws://api.cosm.com:8080");
		socket.onopen = function() {
			socket
					.send('{"method" : "subscribe", "resource" : "/feeds/129364", "headers" : {"X-ApiKey" : "AvKdOy4jlZ7QNRoJjwS_F6q30m-SAKw5S0JEdzZrT3NMZz0g"}}');
		}
		socket.onclose = function() {
			//try to reconnect in 5 seconds
			setTimeout(function() {
				startws()
			}, 5000);
		};

		socket.onmessage = function(msg) {
			var response = JSON.parse(msg.data);
			if ("body" in response) {
				var streams = response.body.datastreams;
				for (var i = 0; i < streams.length; i++) {
					st = streams[i];
					var prev = $("#" + st.id);
					var clone = prev.clone();
					clone.css('position', 'absolute');
					clone.css('left', prev.position().left);
					clone.css('top', prev.position().top);
					$('body').append(clone);
					prev.hide();
					if (st.unit) {
						prev.text(st.current_value + " " + st.unit.symbol);
					} else {
						prev.text(st.current_value);
					}
					clone.fadeOut(300, function() {
						clone.remove();
					});
					prev.fadeIn(300);
				}
			}
		};

	}

	google.maps.event.addDomListener(window, 'load', initialize);
</script>
</head>

<body>
	<div class="navbar navbar-inverse navbar-fixed-top">
		<div class="container-fluid">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle" data-toggle="collapse"
					data-target=".navbar-collapse">
					<span class="sr-only">Toggle navigation</span> <span
						class="icon-bar"></span> <span class="icon-bar"></span> <span
						class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="#">Project name</a>
			</div>
			<div class="navbar-collapse collapse">
				<ul class="nav navbar-nav navbar-right">
					<li><a href="home">Dashboard</a></li>
					<li><a href="#">Settings</a></li>
					<li><a href="#">Profile</a></li>
					<li><a href="#">Help</a></li>
					<li class="dropdown"><a href="#" class="dropdown-toggle"
						data-toggle="dropdown">Dropdown <b class="caret"></b></a>
						<ul class="dropdown-menu">
							<li><a href="#">Action</a></li>
							<li><a href="#">Another action</a></li>
							<li><a href="#">Something else here</a></li>
							<li class="divider"></li>
							<li class="dropdown-header">Nav header</li>
							<li><a href="#">Separated link</a></li>
							<li><a href="#">One more separated link</a></li>
						</ul></li>
				</ul>
				<form class="navbar-form navbar-right">
					<input type="text" class="form-control" placeholder="Search...">
				</form>
			</div>
		</div>
	</div>

	<div class="container-fluid">
		<div class="row">

			<!--form method="POST" action="weather.x"
				modelAttribute="weatherUser"-->

			<div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
				<h1 class="page-header">Whatever The Weather!</h1>
				<div class="jumbotron">
					<div class="container">
						<div class="row">
							<div class="span2"></div>
							<div class="span8">
								<p>
									<button type="submit" value="Get My Location" id="geolocate"
										class="btn btn-primary btn-lg">My Location</button>
									<button type="submit" value="Run Weather Report" id="submit"
										class="btn btn-primary btn-lg">Get Weather</button>
								</p>
							</div>
						</div>
					</div>
				</div>
				<div class="row placeholders">
					<div class="col-xs-6 col-sm-3 placeholder">
						<img data-src="holder.js/200x200/auto/sky" class="img-responsive"
							alt="Generic placeholder thumbnail">
						<p>Location</p>
						<table>
							<tr>
								<td>
									<!--form:label path="latitude">Latitude</form:label-->
								</td>
								<td>
									<!--form:input path="latitude" id="latitude" /-->
								</td>
							</tr>
							<tr>
								<td>
									<!--form:label path="longitude">longitude</form:label-->
								</td>
								<td>
									<!--form:input path="longitude" id="longitude" /-->
								</td>
							</tr>
						</table>
					</div>
					<div class="col-xs-6 col-sm-3 placeholder" id="map_canvas"></div>
				</div>
				<!--/form-->

				<h2 class="sub-header">Weather Reports</h2>

				<div class="container-fluid">
					<div class="row">
						<b>Weather Report for: ${report.region}, ${report.latitude},
							${report.longitude}, ${report.date}</b> <br />
						<!--c:forEach items="${report.sourceMap}" var="entry">
						<c:set var="sourcedata" value="${entry.value}" />
						<c:set var="source" value="${entry.key}" />

						<b>Current Weather Conditions for: ${report.region},
							${report.latitude}, ${report.longitude}, ${report.date}</b>
						<br />
						<b>From Source: ${source}</b>
						<br />

						<ul>
							<li>Min Temperature: ${sourcedata.current.condition.minTemp}</li>
							<li>Max Temperature: ${sourcedata.current.condition.maxTemp}</li>
							<li>Condition: ${sourcedata.current.condition.text}</li>
							<li>Humidity: ${sourcedata.current.atmosphere.humidity}</li>
							<li>Wind Chill: ${sourcedata.current.wind.chill}</li>
							<li>Date: ${sourcedata.current.writeTime}</li>
						</ul>

						<b>Forecast Weather Conditions for: ${report.region},
							${report.latitude}, ${report.longitude}, ${report.date}</b>
						<br />
						<b>From Source: ${source}</b>
						<br />

						<c:forEach items="${sourcedata.forecasts}" var="forecast">
							<ul>
								<li>From source: <c:out value="${forecast.source}" /></li>
								<li>Min Temperature: <c:out
										value="${forecast.condition.minTemp}" /></li>
								<li>Max Temperature: <c:out
										value="${forecast.condition.maxTemp}" /></li>
								<li>Condition: <c:out value="${forecast.condition.text}" /></li>
								<li>Humidity: <c:out
										value="${forecast.atmosphere.humidity}" /></li>
								<li>Wind Chill: <c:out value="${forecast.wind.chill}" /></li>
								<li>From Time: <c:out
										value="${forecast.condition.fromTime}" /></li>
								<li>To Time: <c:out value="${forecast.condition.toTime}" /></li>
							</ul>
						</c:forEach>
						<br />
					</c:forEach-->

					</div>

				</div>

			</div>

		</div>
		<div class="row">
			<div class="container">
				<div class="row-fluid">
					<div id="content" class="span12>"></div>
				</div>
			</div>
		</div>
		<footer>
			<p>&copy; Company 2014</p>
		</footer>

	</div>

	<!--script src="lib/jquery-1.9.1.min.js"></script>
	<script src="lib/underscore-min.js"></script>
	<script src="lib/backbone-min.js"></script>
	<script src="bootstrap/js/bootstrap.js"></script-->

	<script src="js/app.js"></script>
	<script src="js/views/shell.js"></script>
	<script src="js/views/home.js"></script>
	<script src="js/views/contact.js"></script>
	<script src="js/views/employeelist.js"></script>
	<script src="js/views/employeedetails.js"></script>

	<!-- SELECT ONE (AND ONLY ONE) OF THE DATA PERSISTENCE SOLUTIONS BELOW -->

	<!-- Uncomment the script below to access the application data using an in-memory data store -->
	<script src="js/models/model-in-memory.js"></script>

	<!-- Uncomment the script below to access the application data using RESTful services. Open model-rest.js and adjust the URL attributes to reflect your URL endpoints. -->
	<!--<script src="js/models/model-rest.js"></script>-->

	<!-- Uncomment the script below to access the application data using RESTful services with JSONP. Open model-rest.js and adjust the URL attributes to reflect your REST endpoints. -->
	<!--<script src="js/models/model-rest-jsonp.js"></script>-->

	<!-- Uncomment the two scripts below to use Parse.com as the data persistence layer. -->
	<!--<script src="lib/parse-1.2.2.min.js"></script>-->
	<!--<script src="js/models/model-parse-com.js"></script>-->
	<script type="text/javascript">
		$(document)
				.ready(
						function() {
							$('#geolocate')
									.click(
											function() {
												if (navigator.geolocation) {
													navigator.geolocation
															.getCurrentPosition(
																	geoSuccess,
																	geoError)
												} else {
													alert("Browser does not support geolocation");
												}
											});

							function geoSuccess(position) {
								alert("!!geo located");
								$('#latitude').val(position.coords.latitude);
								$('#longitude').val(position.coords.longitude);
							}

							function geoError(error) {
								switch (error.code) {
								case error.PERMISSION_DENIED:
									alert("Geolocate PERMISSION_DENIED: "
											+ error.message);
									break;
								case error.POSITION_UNAVAILABLE:
									alert("Geolocate POSITION_UNAVAILABLE: "
											+ error.message);
									break;
								case error.TIMEOUT:
									alert("Geolocate TIMEOUT: " + error.message);
									break;
								default:
									alert("Geolocate code " + error.code + ': '
											+ error.message);
									break;
								}
							}

						});
	</script>
	<script type="text/javascript">
		var GoSquared = {};
		GoSquared.acct = "GSN-287476-A";
		(function(w) {
			function gs() {
				w._gstc_lt = +new Date;
				var d = document, g = d.createElement("script");
				g.type = "text/javascript";
				g.src = "//d1l6p2sc9645hc.cloudfront.net/tracker.js";
				var s = d.getElementsByTagName("script")[0];
				s.parentNode.insertBefore(g, s);
			}
			w.addEventListener ? w.addEventListener("load", gs, false) : w
					.attachEvent("onload", gs);
		})(window);
	</script>
	<script type="text/javascript">
		var _gauges = _gauges || [];
		(function() {
			var t = document.createElement('script');
			t.type = 'text/javascript';
			t.async = true;
			t.id = 'gauges-tracker';
			t.setAttribute('data-site-id', '510e99ccf5a1f50f85000093');
			t.src = '//secure.gaug.es/track.js';
			var s = document.getElementsByTagName('script')[0];
			s.parentNode.insertBefore(t, s);
		})();
	</script>
	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push([ '_setAccount', 'UA-38207510-1' ]);
		_gaq.push([ '_trackPageview' ]);

		(function() {
			var ga = document.createElement('script');
			ga.type = 'text/javascript';
			ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl'
					: 'http://www')
					+ '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0];
			s.parentNode.insertBefore(ga, s);
		})();
	</script>
</body>
</html>